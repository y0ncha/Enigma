# GitHub Copilot Instructions — Enigma Machine Project
### These rules ensure Copilot generates assignment-compliant code.

---

# 1. Architecture Constraints (Strict)

Copilot **must** follow the module boundaries:

- `machine` — domain logic only
- `engine` — validation, orchestration, history
- `loader` — XML parsing & validation
- `console` — UI-only
- `server` — Spring controllers + services

Copilot should never generate:

- Printing inside engine/machine/loader
- Exposure of internal machine objects
- Hardcoded XML paths
- Hebrew text
- Business logic inside UI
- Static helper blobs

---

# 2. Code Style Rules

- Java 21
- Naming conventions:
    - Classes — UpperCamelCase
    - Methods/vars — lowerCamelCase
    - Constants — UPPER_SNAKE_CASE
- Prefer immutable data structures
- Avoid long methods and duplicate logic

---

# 3. Documentation & Comments

- Follow CONTRIBUTING.md rules
- Keep Javadoc minimal and contract-focused
- Inline comments should explain “why,” not “what”

# 3.1 When the user asks for documentation (explicit rule)

- Produce concise documentation (short, focused, complete):
  - One-line summary describing responsibility/purpose.
  - Short parameter list (1–2 words per param) and return description if applicable.
  - 1–3 line usage example (compact and copy-pasteable).
  - A short bullet list of important invariants or side-effects (max 3 items).
- Avoid long essays, historical notes, or implementation rationale unless the user explicitly asks for a long-form doc.
- Prefer clear, precise language and code examples over prose.

---

# 4. Validation Rules Copilot Must Enforce

### XML Loader
- Alphabet size even
- Rotor IDs form continuous sequence
- Rotor mappings bijective
- No reflector self-mapping
- Reflector Roman IDs unique
- `rotors-count` within allowed range
- Invalid XML must not override current machine

### Code Configuration
- Rotor IDs valid
- Rotor count matches spec
- Positions valid
- Reflector exists
- Plugboard valid: even length, no repetitions, no self-mapping

### Input Validation
- Characters must belong to alphabet

---

# 5. Behavior Rules Copilot Must Follow

- Rotors stored internally left→right (index 0 = leftmost, highest index = rightmost)
- Rightmost rotor (highest index) always steps first
- Double-stepping logic enforced
- Processing modifies rotor positions
- Reset restores original configuration
- History tracked per code configuration

---

# 6. DTO Rules (Mandatory)

- Engine returns DTOs only
- No domain objects cross module boundaries
- DTOs immutable
- Used for both console & Spring controllers

---

# 7. Spring Boot (Exercise 3)

- Root path: `/enigma`
- Controllers handle routing only
- Services contain all logic
- JSON exactly matches Postman spec
- Must produce `enigma-machine-server-ex3.jar`

---

# 8. Copilot Behavior in This Repo

Copilot should:

- Suggest reorganizations but not change logic
- Prioritize clarity, modularity, and alignment with the conventions
- Avoid generating unused code, commented code, or shortcuts

Copilot must not violate the architecture or validation rules under any circumstances.
